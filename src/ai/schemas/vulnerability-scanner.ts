import {z} from 'genkit';

export const VulnerabilityScannerInputSchema = z.object({
  url: z.string().url().describe('The URL of the website to scan.'),
});
export type VulnerabilityScannerInput = z.infer<typeof VulnerabilityScannerInputSchema>;

const VulnerabilityFindingSchema = z.object({
  vulnerability: z.string().describe('The name of the potential vulnerability (e.g., "Cross-Site Scripting (XSS)", "SQL Injection").'),
  description: z.string().describe('A detailed explanation of the vulnerability, what it is, and why it is a risk.'),
  severity: z.enum(['Critical', 'High', 'Medium', 'Low', 'Informational']).describe('The severity level of the finding.'),
  recommendation: z.string().describe('The recommended action to mitigate this vulnerability.'),
});

export const VulnerabilityScannerOutputSchema = z.object({
  findings: z.array(VulnerabilityFindingSchema).describe('A list of potential vulnerabilities found.'),
  summary: z.string().describe('A high-level summary of the security posture based on the findings.'),
});
export type VulnerabilityScannerOutput = z.infer<typeof VulnerabilityScannerOutputSchema>;
